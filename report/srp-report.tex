\documentclass[letterpaper]{erdc}
\usepackage[all]{draftcopy}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{calc}
\usepackage{verbatim}
\usepackage{appendix}
\usepackage{multirow}
\usepackage[section]{placeins}
\newtheorem{thm}{Theorem}[section]
\graphicspath{{graphics/}{graphics/2dbox_pngs/},{graphics/saltdome_pngs/}{graphics/elder_pngs/}{graphics/saltpool3d_pngs/}{graphics/3dbox_pngs/}{graphics/henry2d_pngs/},{graphics/goswami_clement_pngs/}}

\include{include}

\begin{document}

\frontmatter

\laboratory{Coastal and Hydraulics Laboratory}
\reportnum{ERDC/CHL TR-00-00}
\program{HPCMP/Military Engineering 6.2}

\title{Finite Element Methods for Variable Density Flows}

\author{S. R. Patty}
\affiliation{Department of Mathematics \\
Texas A\& M University\\
College Station, TX 77843-3368}

\author{C. N. Dawson}
\affiliation{Computational Hydraulics Group \\
1 University Station, C0200 \\
The University of Texas at Austin \\
Austin, TX 78712}

\author{M. W. Farthing \and C. E. Kees}
\affiliation{Coastal and Hydraulics Laboratory\\
  U.S. Army Engineer Research and Development Center\\
  3909 Halls Ferry Road\\
  Vicksburg, MS 39180-6199}

\coverart{coetr_gc_frontpage.pdf}
%
%rough bottom
%

\reporttype{Final Report}

% \distribution{Distribution authorized to U.S. Government Agencies
% only; Test and Evaluation; November 2005.  Other requests should be
% referred to U.S. Army Engineer Research and Development Center}

%\additionalinfo{Supersedes ERDC/CREL AF-01-23}

\begin{abstract}
 Saltwater intrusion into coastal freshwater aquifers is an ongoing problem that will continue to impact coastal freshwater resources as coastal populations increase.   To effectively model saltwater intrusion, the impacts of  salt content on fluid density must be accounted for to properly model saltwater/freshwater transition zones and sharp interfaces.  We present a model for variable density fluid flow and solute transport where a conforming finite element method discretization with a locally conservative velocity post-processing method is used for the flow model and a variational multi-scale stabilized conforming finite element method is used for transport.   This formulation provides a consistent velocity and performs well even in advection-dominated problems that can occur in saltwater intrusion modeling. The physical model is presented as well as the formulation of the numerical model and solution methods. The model is tested against several 2D and 3D numerical and experimental benchmark problems and the results are presented to verify the code. 
\end{abstract}

%\disclaimer{Some other disclaimer}
%\preparedfor{U.S. Army Engineer Research and Development Center\\
% 3909 Halls Ferry Road, Vicksburg, MS 39180-6199} 

\contractnum{PP-EQM-KY01-001-P3, DD2DK8}

%\monitoredby{U.S. Army Engineer Research and Development Center\\
%  3909 Halls Ferry Road, Vicksburg, MS 39180-6199}

%\preparedfor{}

\maketitle
\setcounter{tocdepth}{1}
\tableofcontents

\listoffiguresandtables
%\listoffigures
%
\chapter{Preface}

This report is a product of the User Productivity Enhancement,
Technology Transfer, and Training (PETTT) Program in the Environmental
Quality Modeling (EQM) computational technology area of the Department
of Defense High Performance Computing Modernization Office and of the
Multiscale and Fluid-Structure Interaction work unit of the ERDC
Military Engineering 6.2 program. The report was prepared by LTC
Timothy Povich and Dr. Clint Dawson of the Institute for Computational
Engineering and Science at the University of Texas, Austin and by
Drs. Christopher E. Kees and Matthew W. Farthing of the Hydrologic
Systems Branch.  General supervision was provided by Dr. William
D. Martin, Director, CHL; Dr. Charles A. Randall was the project
manager for this eï¬€ort. Dr. David A. Horner was the Technical
Director. COL Kevin J. Wilson was Commander and Executive Director of
the Engineer Research and Development Center. Dr. Jeffrey P. Holland
was Director.

\mainmatter

\chapter{Introduction}

% why choose this method over others?  because of the variable coefficient laplacian equation which is hard to solve well
%\[ \nabla\cdot \left( \frac{1}{\rho^{k+1} \nabla \phi} \right) = \Psi,\hspace{1.5cm} \left.\partial_{\n}\phi\right|_{\partial\Omega} = 0 \]

%
%
%
%
\chapter{Variable Density Incompressible Navier-Stokes Time Stepping Techniques}

%
%
%
\section{Preliminaries}

%
%
\subsection{Notation}
Find the solutions at time $t^{k+1}$
\begin{equation}(\rho^{k+1}_h, \ub^{k+1}_{h}, p^{k+1}_h) \in W_h\times\X_h\times M_h  \end{equation}

%
%
%
\section{Penalty-like Perturbation of Continuous Equations}

Solve the perturbed Navier-Stokes system
\begin{equation}
  \begin{cases}
    \rho\left(\ub_t + \ub\cdot\nabla\ub  \right) + \nabla p -\mu\Delta\ub = \fb, & \left.\ub\right|_{\partial\Omega} = 0\\
    \nabla\cdot\ub - \frac{\veps}{\rho}\Delta \phi = 0,& \partial_\n \phi = 0\\
    \veps p_t = \phi
  \end{cases}
\end{equation}

%
%
%
\section{BDF1 Incremental Rotational Scheme}

%
%
\subsection{Time-stepping technique}
We proceed in a three step update scheme.  First we update the density,  second the velocity, and third the pressure.  So given
\begin{equation}(\rho^{k}_h, \ub^{k}_{h}, p^{k}_h) \in W_h\times\X_h\times M_h  \end{equation}
we update to obtain
\begin{equation}(\rho^{k+1}_h, \ub^{k+1}_{h}, p^{k+1}_h) \in W_h\times\X_h\times M_h.\end{equation}

%
\subsubsection{Density Update}

We first solve the hyperbolic system with a monotone preserving scheme such as subgrid viscosity, edge stabilization or entropy viscosity using a DG or CG solver.  The equation of update is

\begin{equation}
  \frac{\rho^{k+1} - \rho^k}{\tau^{k+1}} + \nabla\cdot\left(\rho_h^{k+1}\ub^{k} \right) - \frac{\rho^{k+1}}{2}\nabla\cdot\ub^{k} = 0
\end{equation}
where the last term is a consistent stabilization which leads to unconditional stability of the scheme.   Our choice of hyperbolic solver scheme doesn't matter as long as it satisfies the following stability hypothesis:
\begin{equation}
  \chi \leq \displaystyle\min_{\x\in\overline{\Omega}} \rho_h^{k+1}(\x), \hspace{2cm} \displaystyle\max_{\x\in\overline{\Omega}} \rho_{h}^{k+1}(\x) \leq c_{\rho}
\end{equation}
for all $k\geq 1$.

Thus we obtain the weak solution $\rho_h^{k+1}\in W_h$ that satifies the above requirements.

% In particular we seek the weak solution $\rho_h^{k+1}\in W_h$ such that
% 
% \begin{equation}
%   \dprod{ \frac{\rho^{k+1} - \rho^k}{\tau^{k+1}} }{w_h} + \dprod{\nabla\cdot\left(\rho_h^{k+1}\ub^{k} \right)}{w_h} - \dprod{\frac{\rho^{k+1}}{2}\nabla\cdot\ub^{k}}{w_h} = 0
% \end{equation}


%
\subsubsection{Velocity Update}
Once we have the density $\rho_h^{k+1}$ we can now solve for the velocity.  It turns out that we do not explicitly require this velocity to be divergence free, but simply penalize the divergence using the pressure rotational update.  We define our update terms
\begin{align*}
  \rho_h^{*} &= \frac{1}{2}\left( \rho_h^{k+1} - \rho_h^{k} \right)\\
  \delta p_h^{k} &= p_h^{k} - p_h^{k-1}\\
    p_h^{\#} &= p_h^{k} + \delta p_h^{k} = 2p_h^{k} - p_h^{k-1}
\end{align*}
so that $p_h^{\#}$ is a second order extrapolation of pressure to time $t^{k+1}$.  Next we  solve for $\ub_h^{k+1}\in\X_h$ that satisfies the following system for all $\vb_h\in\X_h$,
\begin{equation}
  \begin{split}
\dprod{ \frac{\rho_h^{*}\ub_h^{k+1}-\rho_h^{k}\ub_h^{k} }{\tau^{k+1}} }{\vb_h} + \dprod{ \rho_h^{k+1}\ub_h^{k}\cdot\nabla\ub_h^{k+1} }{\vb_h}&\\
 + \dprod{ \frac{1}{2}\nabla\cdot\left(\ub_h^{k}\right)\ub_h^{k+1} }{\vb_h} + \mu\dprod{ \nabla \ub_h^{k+1} }{\nabla\vb_h}&\\
  +\dprod{\nabla p_h^{\#}}{\vb_h} &= \dprod{\fb^{k+1}}{\vb_h}.
\end{split}
\end{equation}

%
\subsubsection{Pressure Update}
Now that we have $\rho_h^{k+1}$ and $\ub_h^{k+1}$, we solve for the pressure increment $\phi_h^{\flat}\in M_h$ which then allows us to solve for the pressure $p_h^{k+1}\in M_h$.  
Recalling that $\chi \leq \displaystyle\min_{\x\in\overline{\Omega}} \rho_h^{k+1}(\x)$ (note that we will often choose it to be the minimum), we let $\phi_h^{\flat}\in M_h$ be the weak solution of
\begin{equation}
  \Delta \phi^{\flat} = \frac{\chi}{\tau^{k+1}}\nabla\cdot \ub^{k+1}, \hspace{1cm} \left.\partial_\n\phi^{\flat}\right|_{\partial\Omega} = 0
\end{equation}
mainly it solves
\begin{equation}
  \dprod{\nabla\phi_h^{\flat}}{\nabla r_h} = \frac{\chi}{\tau^{k+1}}\dprod{\ub_h^{k+1}}{\nabla r_h}
\end{equation}
for all $r_h \in M_h$.  Then we update the pressure as
\begin{equation}
  p^{k+1} = \phi^{\flat} + p^{k} - \mu\nabla\cdot \ub^{k+1},
\end{equation}
or in other words, we solve for $p_h^{k+1}\in M_h$ such that for all $r_h\in M_h$
\begin{equation}
  \dprod{p_h^{k+1}}{r_h} = \dprod{\phi_h^{\flat} + p_h^{k}}{r_h} + \mu\dprod{\ub_h^{k+1}}{\nabla r_h}.
\end{equation}
The last term involving the divergence of velocity makes this the rotational form and leaving it off is the standard form.  In standard form, it is simple enough to just add $p_h^{k+1}$ and $\phi_h^{\flat}$ to update $p_h^{k+1}$ instead of solving the linear system.





\section{BDF2 Incremental Rotational Scheme}




\bibliographystyle{chicago}
\bibliography{ps.bib}
\appendix
%\input{GWVD_COETR_Consistent_Velocity_Appendix}
%\input{GWVD_COETR_Velocity_Postprocessing_Appendix}
%input{GWVD_COETR_variational_multiscale_appendix}

\end{document}
